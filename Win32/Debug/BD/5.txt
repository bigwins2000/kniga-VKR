Событие 
Вид созданной формы подсказывает, как работает программа. Очевидно, что пользователь должен ввести в поля редактирования исходные данные и сделать щелчок на кнопке Пересчет. Щелчок на изображении командной кнопки — это пример того, что называется событием. 
Событие (event) — это то, что происходит во время работы программы. У каждого события есть имя. Например, щелчок кнопкой мыши — это событие Click, двойной щелчок мышью — событие DblClick. 
В табл. 2.9 приведены некоторые события, возникающие в результате действий пользователя. 
Таблица 2.9. События  
 
2.9 (окончание) 
Событие 	Описание 
MouseDown 	Нажатие кнопки мыши 
MouseUp 	Отпускание нажатой кнопки мыши 
MouseMove 	Перемещение указателя мыши 
KeyPress 	Нажатие клавиши клавиатуры 
KeyDown 	Нажатие клавиши клавиатуры. События KeyDown и KeyPress — это чередующиеся, повторяющиеся события, которые происходят до тех пор, пока не будет отпущена удерживаемая клавиша (в этот момент происходит событие KeyUp) 
KeyUp 	Отпускание нажатой клавиши клавиатуры 
Create 	Создание объекта (формы, элемента управления). Процедура обработки этого события обычно используется для инициализации переменных, выполнения подготовительных действий 
Paint 	Событие происходит при появлении окна на экране в начале работы программы, после появления части окна, которая, например, была закрыта другим окном 
Enter 	Получение элементом управления фокуса 
Exit 	Потеря элементом управления фокуса 
 
Следует понимать, что одни и те же действия, но выполненные над различными объектами, вызывают разные события. Например, щелчок (событие Click) на кнопке Пересчет и щелчок на кнопке Завершить — это два разных события. 
Процедура обработки события 
Реакцией на событие должно быть какое-либо действие. В Delphi реакция на событие реализуется как процедура обработки события. Таким образом, для того чтобы программа выполняла некоторую работу в ответ на действия пользователя, программист должен написать процедуру обработки соответствующего события. 
Методику создания процедуры обработки события рассмотрим на примере обработки события Click, которое возникает в результате щелчка на кнопке Пересчет. 
Чтобы приступить к созданию процедуры обработки события, сначала надо выбрать компонент, для которого создается процедура обработки события. Для этого в окне конструктора формы надо сделать щелчок левой кнопкой мыши на нужном компоненте (компонент можно выбрать также в раскрывающемся списке, который находится в верхней части окна Object Inspector). Затем в окне Object Inspector нужно открыть вкладку Events. 
В левой колонке вкладки Events (рис. 2.19) перечислены события, которые может воспринимать выбранный компонент. Строго говоря, на вкладке Events указаны не события, а свойства, значением которых являются имена процедур обработки соответствующих событий. Так, например, значением свойства OnClick является имя процедуры обработки события Click. 
  
Рис. 2.19. На вкладке Events перечислены события,  которые может воспринимать компонент Для того чтобы создать процедуру обработки события, нужно на вкладке Evens выбрать событие (сделать щелчок мышью на его имени), ввести имя процедуры обработки события в ставшее доступным поле редактирования (рис. 2.20) и нажать клавишу <Enter>. 
В результате этих действий в текст программы (в модуль формы) будет добавлена процедура обработки события и станет доступным окно редактора кода (рис. 2.21), в котором можно набирать инструкции процедуры обработки события. Следует обратить внимание на то, что формируемое средой разработки полное имя процедуры обработки события состоит из двух частей. Первая часть идентифицирует форму, вторая представляет собой непосредственно имя процедуры. Согласно принятому соглашению имя процедуры обработки должно содержать информацию о компоненте, реагирующем на событие, и событии. Например, Button1Click — это имя процедуры обработки события Click на компоненте Button1.  
Существует и другой способ создания процедуры обработки события. Сначала на вкладке Events надо выбрать событие, процедуру обработки которого необходимо создать, затем сделать двойной щелчок левой кнопкой мыши в поле редактирования, которое находится справа от имени события. В результате имя процедуры обработки события сформирует Delphi (имя процедуры обработки события образуется путем объединения имени компонента, для которого создается процедура обработки события, и имени события, например Button1Click). 
 
Рис. 2.20. Рядом с именем события надо ввести имя процедуры обработки события 
 
Рис. 2.21. Шаблон процедуры обработки события 
В листинге 2.1 приведен текст процедуры обработки события Click на кнопке Пересчет. Обратите внимание на то, как представлена программа. Ее общий вид соответствует тому, как она выглядит в окне редактора кода: ключевые слова выделены полужирным, комментарии — курсивом (выделение выполняет редактор кода). Кроме того, инструкции программы набраны с отступами в соответствии с правилами хорошего стиля программирования. 
Листинг 2.1. Обработка события Click на кнопке Пересчет 
procedure TForm1.Button1Click(Sender: TObject); var 
  usd: real;   // цена в долларах   k:   real;   // курс   rub: real;   // цена в рублях 
 begin 
  // получить данные из полей редактирования   k := StrToFloat(Edit1.Text);   usd := StrToFloat(Edit2.Text); 
 
  // пересчитать цену из долларов в рубли   rub := usd * k; 
 
  // вывести результат расчета в поле Label3 
  Label3.Caption := FloatToStrF(usd,ffGeneral, 6,2) + ' $ = ' +                     FloatToStrF(rub,ffCurrency,6,2); end; 
Процедура TForm1.Button1Click пересчитывает цену из долларов в рубли и выводит результат в поле Label3. Исходные данные (курс и цена в долларах) вводятся из полей редактирования Edit1 и Edit2 путем обращения к свойству Text. Значением свойства Text является строка, которая находится в поле редактирования. Свойство Text строкового типа, поэтому для преобразования строки в число используется функция StrToFloat. Следует обратить внимание, что функция StrToFloat возвращает результат только в том случае, если строка, переданная функции в качестве параметра, действительно является изображением числа в правильном формате, что предполагает использование запятой (при стандартной для России настройке операционной системы) в качестве разделителя целой и дробной частей числа. Вычисленное значение цены в долларах выводится в поле Label3 путем присваивания значения свойству Caption. Для преобразования числа в строку (свойство Caption строкового типа) используется функция FloatToStrF.  У функции FloatToStr четыре параметра: первый — значение, которое надо преобразовать в строку; второй — формат (ffGeneral — обычное число, ffCurrency — финансовый); третий и четвертый задают соответственно общее количество цифр и количество цифр дробной части. 
ЗАМЕЧАНИЕ 
Для преобразования строки в целое число и целого числа в строку используйте соответственно методы-функции StrToInt и IntToStr. 
В листинге 2.2 приведена процедура обработки события Click на кнопке Завершить (создается она точно так же, как и процедура обработки события Click для кнопки Пересчет). В результате щелчка на кнопке Завершить программа должна завершить работу. Чтобы это произошло, надо закрыть окно программы (форму). Делает это метод Close. 
Листинг 2.2. Обработка события Click на кнопке Завершить 
procedure TForm1.Button2Click(Sender: TObject); begin 
  Form1.Close; // закрыть окно end; 
